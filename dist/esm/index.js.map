{"version":3,"file":"index.js","sources":["../../src/index.ts"],"sourcesContent":["import openData from '../open-data.json';\n\nconst hostUrl = 'https://ckan.pf-sapporo.jp/api/3/action/datastore_search';\n\nconst pickParams = (obj: Record<string, string> | undefined, arr: string[]) => {\n  if (!obj) return undefined;\n  return arr.reduce((acc, record) => {\n    if (record in obj) acc[record] = obj[record];\n    return acc;\n  }, {});\n};\nconst odisap = async (\n  group: keyof typeof openData,\n  resourceId: string,\n  params?: Record<string, string>,\n  limit = 100\n) => {\n  try {\n    const resource = openData[group];\n\n    if (!resource[resourceId]) throw new Error('Invalid resourceId');\n\n    const paramKeys = Object.keys(resource[resourceId as keyof typeof resource].param);\n\n    const searchParams = new URLSearchParams({\n      resource_id: resourceId,\n      limit: `${limit}`,\n      ...pickParams(params, paramKeys),\n    });\n\n    const url = `${hostUrl}?${searchParams.toString()}`;\n    console.log(url);\n    // const res = await fetch(url);\n\n    // return await res.json();\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nexport default odisap;\n\nodisap('statistics_sapporo', '821c83f6-492b-44db-bbde-fca9d2774645');\n"],"names":["open_data_json_1","__importDefault","require","pickParams","obj","arr","reduce","acc","record","odisap","async","group","resourceId","params","limit","resource","default","Error","paramKeys","Object","keys","param","url","URLSearchParams","resource_id","toString","console","log","err","exports"],"mappings":"6DAAyCA,mBAAAC,gBAAAC,QAAA,sBAInCC,EAAa,CAACC,EAAyCC,KAC3D,GAAKD,EACL,OAAOC,EAAIC,QAAO,CAACC,EAAKC,KAClBA,KAAUJ,IAAKG,EAAIC,GAAUJ,EAAII,IAC9BD,IACN,CAAE,EAAC,EAEFE,EAASC,MACbC,EACAC,EACAC,EACAC,EAAQ,OAER,IACE,MAAMC,EAAWf,EAAAgB,QAASL,GAE1B,IAAKI,EAASH,GAAa,MAAM,IAAIK,MAAM,sBAE3C,MAAMC,EAAYC,OAAOC,KAAKL,EAASH,GAAqCS,OAQtEC,EAAM,4DANS,IAAIC,gBAAgB,CACvCC,YAAaZ,EACbE,MAAO,GAAGA,OACPX,EAAWU,EAAQK,KAGeO,aACvCC,QAAQC,IAAIL,EAIb,CAAC,MAAOM,GACPF,QAAQC,IAAIC,EACb,GAGHC,QAAAb,QAAeP,EAEfA,EAAO,qBAAsB"}